# Workflow

1. Use script [1_process_raw](1_process_raw.py) to reformat the HPA or GTEx
dataset with a format accessible for downstream gene pairwise calculations
Use [1A_gen_random](1A_gen_random.py) to create a subset file containing
a specified number of genes. Regardless, the number of tissues is kept
the same as the source.

2. The script [2_create_matrix](2_create_matrix.py) then takes the output of
ยง1 and creates a distance matrix using 5 possible metrics as follows. At this
stage, it is also possible to drop all the genes with null expression across
all tissues.
    1. Relative-Euclidean
    2. Euclidean
    3. [Mass-Distance](https://dx.doi.org/10.1093/bioinformatics/btl127)
    4. Manhattan
    5. Pearson-Partial Correlation

3. The output from ยง2 can then be fed into [3_prepare_mcl](3_prepare_mcl.py),
for the non-correlation based metrics, the matrix is convereted into similarity-
based, then ranked by thresholding between 0-1 (default is 90% pruning: only
top 10% of values are retained, the rest are nullified). For correlation-based
metric, a partial correlation matrix is generated by inversing the matrix,
if not possible then Moore-Penrose pseudoinverse is calculated instead.
The output is in '--abc' format acceptable by MCL.

4. Run the output of ยง3 on [MCL](https://micans.org/mcl).

5. To cross-reference the genes with the clusters, first run
[4A_process_kegg](4A_process_kegg.py) then feed the MCL output from ยง4 into
[4_kegg_mcl](4_kegg_mcl.py) which will create a Jaccard index-based matrix
pairing each cluster (as defined by MCL) and each (manually-curated) KEGG
pathway. The results of this can be seen [elsewhere](../Results/MCL_Output.ipynb).